# AreaInt Test

# Python
import numpy as np
from PolarCoronalHoles import PCH_stats
import astropy.units as u
import pandas as pd

lats = pd.Series(np.concatenate([np.arange(-90,91,1), np.arange(89, -90, -1)]))
lons = pd.Series(np.concatenate([np.zeros(181), 30*np.ones(179)]))

area = PCH_stats.areaint(lats, lons)[0].value

reallons = pd.Series([ 0.46064168, 2.0015096, 2.0015096, 2.69279382, 7.32003534, 7.37109635, 7.4736734, 7.63526124, 7.87942553, 8.10092443, 12.26548995, 12.2957268, 12.35766316, 12.7783794, 15.17409728, 15.46116698, 16.17734586, 16.50701072, 17.14259955, 21.55648085, 21.87137184, 21.89515139, 22.20439444, 22.49507887, 22.93607775, 26.80961145, 26.919732, 28.12065244, 29.76205506, 31.10561389, 31.16558474, 31.56755632, 36.32940743, 36.86607569, 37.14147906, 38.63133438, 41.3498601, 41.61481766, 42.29297303, 47.15970477, 47.22136216, 51.83698631, 53.53542497, 58.5680272, 59.44824313, 62.36926211, 62.48707015, 67.59637379, 67.87363063, 72.15044656, 72.24989707, 72.29962233, 72.34934758, 77.90510865, 81.13906892, 81.44982436, 82.05646878, 82.57500843, 82.79765909, 85.68430069, 86.8480842, 87.2292009, 87.43433077, 91.41926175, 92.64366918, 92.70963883, 92.82775592, 93.0778123, 99.2626975, 99.8052762, 102.33545369, 102.36894869, 106.81409039, 106.81409039, 107.00858189, 112.87361877, 112.896378, 112.94534542, 118.50282459, 118.82020888, 119.13759317, 120.70594452, 120.74847212, 120.83352734, 127.15222889, 127.98811311, 127.98811311, 131.56551894, 132.01844535, 135.47956637, 135.47956637, 135.55326664, 144.0728378, 144.123356, 144.34182493, 146.9759859, 148.34369014, 148.35988, 153.43272187, 153.5904124, 153.86406466, 157.82257358, 161.60396336, 163.2530544, 166.07196469, 166.27926918, 166.81377046, 172.92767215, 173.71509616, 173.71509616, 173.71509616, 174.08654257, 176.16089493, 176.48153027, 177.0345881, 177.18049293, 182.66475591, 182.86004295, 182.86004295, 182.99069328, 183.07229588, 185.47799496, 185.8003498, 186.09914146, 187.25875832, 187.43098372, 187.96803733, 189.01554846, 191.53555058, 191.71002016, 192.11092028, 197.01713734, 197.03435454, 197.45599023, 197.52960042, 197.6032106, 198.32203689, 202.56940168, 203.03294593, 203.18337626, 203.18337626, 203.18337626, 203.18337626, 203.49649019, 203.57637488, 206.21308547, 207.27428535, 207.27428535, 207.27428535, 207.51502198, 207.76533076, 207.82458185, 211.11714431, 212.38631633, 212.4559515, 214.10956184, 217.47356866, 217.55139021, 217.65555038, 217.87507527, 217.96355676, 217.96355676, 218.7070796, 221.4672544, 221.90948791, 221.90948791, 222.38675983, 222.38675983, 222.50539513, 222.62403044, 226.67646907, 226.80127655, 226.92608402, 227.22025454, 227.24600333, 227.27175212, 227.27175212, 227.27715512, 232.85322196, 233.02362455, 233.26808577, 236.35133027, 236.6349628, 236.67262341, 236.74181977, 237.0214146, 241.16137483, 241.17812894, 242.24630536, 242.45619971, 242.69600116, 246.84110903, 247.17335787, 247.20401753, 247.4430794, 248.16027382, 251.34609744, 251.37478354, 251.38434558, 251.75090792, 251.91229781, 251.91229781, 256.2020945, 256.2020945, 257.57267881, 258.08510577, 260.93402193, 261.04543081, 262.34183918, 266.84986095, 266.99128521, 267.16023899, 268.01645283, 268.17663921, 270.05152573, 271.23772056, 271.63985637, 272.12793091, 273.42462485, 276.70912389, 276.85714514, 277.0954087, 277.31922067, 278.01041753, 278.1272008, 279.99839237, 281.44901668, 282.21729185, 282.57244931, 282.88568264, 283.58853418, 287.85901494, 288.29374707, 288.51473616, 288.64420632, 288.94529356, 288.98672483, 289.03199759, 289.31916338, 291.78517391, 291.8197399, 292.12531727, 292.46546064, 292.46546064, 292.75716826, 295.56229167, 295.61051653, 296.00107666, 296.15724666, 296.31097564, 296.31341666, 296.43769062, 296.66221242, 301.39196813, 301.47994535, 301.56594118, 301.8197709, 302.40728836, 302.40728836, 302.97765237, 303.14485808, 303.54801638, 307.05816444, 307.26853189, 307.47889934, 308.3230669, 309.42134978, 311.25816355, 311.83906114, 312.25118426, 313.16233763, 318.56283725, 318.67260731, 319.18135363, 321.8197399, 321.8859677, 322.41275362, 322.60569477, 326.71645701, 327.04072591, 327.13206333, 327.20913936, 327.24054668, 327.36329142, 327.47024346, 332.90082501, 333.48640081, 333.52835043, 333.52835043, 333.57030005, 333.65419929, 333.800571, 336.77759255, 336.83698796, 336.89638337, 336.89638337, 337.87341178, 338.04725924, 338.10404277, 338.33467377, 338.33467377, 338.53577344, 341.88642662, 341.90091034, 342.70823275, 342.71580084, 343.18244163, 343.36018732, 344.81520683, 346.74980293, 346.94601431, 347.99959935, 348.26852322, 348.55615914, 348.55615914, 348.57037453, 349.11039574, 350.69679229, 351.20719509, 351.40738906, 351.55435898, 351.5762586, 351.88208475, 352.00003529, 357.27064552, 357.27064552, 357.30412793, 357.33761034, 357.59471722])
reallats = pd.Series([-64.42584563, -64.42584563, -51.9157984 , -68.16581176, -62.94481957, -63.84342467, -65.12200569, -62.94481957, -58.19337346, -63.20413417, -59.24569698, -73.57595893, -65.71550568, -73.57595893, -61.77109817, -67.35979729, -71.56636218, -66.71357904, -63.79264761, -62.41875341, -66.57589235, -67.33603103, -69.36022166, -62.5691665 , -62.34354687, -63.87204604, -63.41680408, -64.66910674, -64.32728801, -68.12666807, -67.48675127, -75.62084776, -68.32427247, -67.67873579, -71.29362044, -75.18151027, -74.82703281, -67.86003833, -67.53517002, -74.60769029, -74.47452896, -74.91300782, -69.20265748, -66.4523317 , -74.39535647, -67.84515592, -72.77129315, -65.99697951, -71.56304732, -73.25770588, -64.98109464, -66.7839299 , -65.3361847 , -63.96501392, -73.34798016, -69.00726035, -74.26508002, -74.26508002, -73.34798016, -64.36517353, -64.38103714, -67.84968026, -67.19293516, -62.51751923, -68.14626934, -67.98795927, -68.14626934, -62.66801348, -62.12584867, -50.40471644, -60.67970355, -67.99180558, -64.94934859, -67.41116723, -58.46531032, -65.55092427, -61.35232494, -62.39986155, -64.65797097, -64.65797097, -64.65797097, -66.31522913, -67.19630593, -64.4758729 , -63.17304399, -63.15094628, -63.06302112, -66.5695509 , -66.75645436, -65.70093238, -63.74791344, -66.66411226, -66.06983997, -66.06983997, -64.92589311, -66.11422109, -65.28693894, -64.84893732, -66.09888691, -69.41390112, -65.92144785, -57.770805 , -68.465629 , -63.8091461 , -64.75520112, -65.88124149, -64.23664359, -67.05357444, -63.51404137, -67.8206899 , -70.59310751, -67.05357444, -62.23289118, -63.65864576, -61.54378586, -61.54378586, -65.30519711, -65.56706329, -63.04774047, -62.95983271, -65.53065622, -62.48052497, -60.94278714, -61.45536642, -65.56767367, -69.61479762, -69.18057561, -67.90518311, -74.43563186, -67.45603438, -74.4227941 , -62.52800906, -63.66936825, -66.8489844 , -66.28964469, -64.49678719, -63.39356194, -63.78928175, -67.40852116, -71.13068507, -70.41447682, -72.38686962, -71.13068507, -65.53675116, -65.53401945, -58.22067082, -69.73709741, -66.9075402 , -68.32896736, -66.79928207, -63.22453105, -66.77649314, -74.1482634 , -73.23093503, -69.42974804, -69.58834498, -70.14080073, -70.193096 , -70.12622046, -65.31358477, -70.155381 , -70.09705991, -56.84150736, -55.15342114, -65.378361 , -65.69112773, -67.54407591, -67.54407591, -67.50639499, -68.60130019, -53.16686497, -69.52846636, -69.52846636, -69.79102763, -69.57304611, -69.57304611, -69.70678535, -69.61762586, -68.96116984, -69.61518915, -68.30715052, -68.01201928, -66.43775068, -66.6878871 , -65.47716953, -67.77602153, -73.72456917, -74.48984592, -72.08181311, -72.04747107, -65.69962825, -74.22955573, -64.1478153 , -68.04027358, -73.00214021, -71.02635051, -67.88449277, -72.13233624, -73.2097843 , -70.65687111, -72.01595235, -73.14414372, -73.04197921, -73.04197921, -66.89621171, -66.99719153, -67.68744918, -73.03377863, -72.72642723, -70.30962423, -72.8702989 , -70.84822341, -72.701883 , -72.13795316, -72.50098363, -70.63554314, -75.02926297, -72.80684985, -74.77777294, -71.19707121, -72.1927501 , -71.98969722, -74.64400101, -69.81248824, -75.1721882 , -76.49109604, -71.48912201, -71.76343412, -72.41217668, -71.62627806, -76.06263875, -71.18258268, -55.35787864, -74.91470119, -71.26233118, -71.67019841, -75.64066644, -50.06909651, -76.2327039 , -75.50306682, -85.19972204, -74.97510251, -75.20475515, -76.20726652, -70.75686069, -76.18247511, -76.18247511, -70.43048812, -69.74422932, -75.52863661, -69.93226411, -73.63826058, -69.68089591, -69.88194666, -69.20282695, -70.10756704, -74.39051557, -75.6624949 , -73.11853624, -74.47217578, -71.1521534 , -75.82581533, -67.91269949, -70.91462916, -67.92601711, -72.06926192, -70.78083976, -69.82668687, -67.68461106, -63.50516994, -66.35101086, -69.88478617, -67.47845708, -73.16394193, -66.3626131 , -65.76617758, -65.67934006, -66.87221108, -67.29897774, -65.855567 , -67.92541099, -66.63113361, -67.81643874, -67.76195262, -70.61342985, -67.31858745, -70.10814986, -71.97200741, -75.15957047, -67.15041087, -65.36534693, -67.49385186, -62.46676178, -68.44705032, -66.34823479, -58.58528878, -75.67556585, -66.8394257 , -65.75021804, -68.92313004, -67.33061661, -73.73595866, -68.35916121, -68.5387649 , -70.70484275, -69.68311335, -69.30166386, -64.90444854, -52.47570154, -67.43234283, -70.94056465, -71.63436272, -69.8444062 , -68.34496593, -66.06933826, -65.49977702, -68.94942795, -72.16263106, -72.44436874, -68.73496432, -70.44879769, -65.23261508, -64.9955425 , -64.7003875 , -64.34781389, -58.92285444, -70.77308686, -64.58934439, -68.71183937])

area2 = PCH_stats.areaint(reallats, reallons)[0].value

; matlab 

lats = [-90:1:90,89:-1:-89]';
lons = [zeros(1,181), 30*ones(1,179)]';
area = areaint(lats,lons)

reallons = transpose([ 0.46064168, 2.0015096, 2.0015096, 2.69279382, 7.32003534, 7.37109635, 7.4736734, 7.63526124, 7.87942553, 8.10092443, 12.26548995, 12.2957268, 12.35766316, 12.7783794, 15.17409728, 15.46116698, 16.17734586, 16.50701072, 17.14259955, 21.55648085, 21.87137184, 21.89515139, 22.20439444, 22.49507887, 22.93607775, 26.80961145, 26.919732, 28.12065244, 29.76205506, 31.10561389, 31.16558474, 31.56755632, 36.32940743, 36.86607569, 37.14147906, 38.63133438, 41.3498601, 41.61481766, 42.29297303, 47.15970477, 47.22136216, 51.83698631, 53.53542497, 58.5680272, 59.44824313, 62.36926211, 62.48707015, 67.59637379, 67.87363063, 72.15044656, 72.24989707, 72.29962233, 72.34934758, 77.90510865, 81.13906892, 81.44982436, 82.05646878, 82.57500843, 82.79765909, 85.68430069, 86.8480842, 87.2292009, 87.43433077, 91.41926175, 92.64366918, 92.70963883, 92.82775592, 93.0778123, 99.2626975, 99.8052762, 102.33545369, 102.36894869, 106.81409039, 106.81409039, 107.00858189, 112.87361877, 112.896378, 112.94534542, 118.50282459, 118.82020888, 119.13759317, 120.70594452, 120.74847212, 120.83352734, 127.15222889, 127.98811311, 127.98811311, 131.56551894, 132.01844535, 135.47956637, 135.47956637, 135.55326664, 144.0728378, 144.123356, 144.34182493, 146.9759859, 148.34369014, 148.35988, 153.43272187, 153.5904124, 153.86406466, 157.82257358, 161.60396336, 163.2530544, 166.07196469, 166.27926918, 166.81377046, 172.92767215, 173.71509616, 173.71509616, 173.71509616, 174.08654257, 176.16089493, 176.48153027, 177.0345881, 177.18049293, 182.66475591, 182.86004295, 182.86004295, 182.99069328, 183.07229588, 185.47799496, 185.8003498, 186.09914146, 187.25875832, 187.43098372, 187.96803733, 189.01554846, 191.53555058, 191.71002016, 192.11092028, 197.01713734, 197.03435454, 197.45599023, 197.52960042, 197.6032106, 198.32203689, 202.56940168, 203.03294593, 203.18337626, 203.18337626, 203.18337626, 203.18337626, 203.49649019, 203.57637488, 206.21308547, 207.27428535, 207.27428535, 207.27428535, 207.51502198, 207.76533076, 207.82458185, 211.11714431, 212.38631633, 212.4559515, 214.10956184, 217.47356866, 217.55139021, 217.65555038, 217.87507527, 217.96355676, 217.96355676, 218.7070796, 221.4672544, 221.90948791, 221.90948791, 222.38675983, 222.38675983, 222.50539513, 222.62403044, 226.67646907, 226.80127655, 226.92608402, 227.22025454, 227.24600333, 227.27175212, 227.27175212, 227.27715512, 232.85322196, 233.02362455, 233.26808577, 236.35133027, 236.6349628, 236.67262341, 236.74181977, 237.0214146, 241.16137483, 241.17812894, 242.24630536, 242.45619971, 242.69600116, 246.84110903, 247.17335787, 247.20401753, 247.4430794, 248.16027382, 251.34609744, 251.37478354, 251.38434558, 251.75090792, 251.91229781, 251.91229781, 256.2020945, 256.2020945, 257.57267881, 258.08510577, 260.93402193, 261.04543081, 262.34183918, 266.84986095, 266.99128521, 267.16023899, 268.01645283, 268.17663921, 270.05152573, 271.23772056, 271.63985637, 272.12793091, 273.42462485, 276.70912389, 276.85714514, 277.0954087, 277.31922067, 278.01041753, 278.1272008, 279.99839237, 281.44901668, 282.21729185, 282.57244931, 282.88568264, 283.58853418, 287.85901494, 288.29374707, 288.51473616, 288.64420632, 288.94529356, 288.98672483, 289.03199759, 289.31916338, 291.78517391, 291.8197399, 292.12531727, 292.46546064, 292.46546064, 292.75716826, 295.56229167, 295.61051653, 296.00107666, 296.15724666, 296.31097564, 296.31341666, 296.43769062, 296.66221242, 301.39196813, 301.47994535, 301.56594118, 301.8197709, 302.40728836, 302.40728836, 302.97765237, 303.14485808, 303.54801638, 307.05816444, 307.26853189, 307.47889934, 308.3230669, 309.42134978, 311.25816355, 311.83906114, 312.25118426, 313.16233763, 318.56283725, 318.67260731, 319.18135363, 321.8197399, 321.8859677, 322.41275362, 322.60569477, 326.71645701, 327.04072591, 327.13206333, 327.20913936, 327.24054668, 327.36329142, 327.47024346, 332.90082501, 333.48640081, 333.52835043, 333.52835043, 333.57030005, 333.65419929, 333.800571, 336.77759255, 336.83698796, 336.89638337, 336.89638337, 337.87341178, 338.04725924, 338.10404277, 338.33467377, 338.33467377, 338.53577344, 341.88642662, 341.90091034, 342.70823275, 342.71580084, 343.18244163, 343.36018732, 344.81520683, 346.74980293, 346.94601431, 347.99959935, 348.26852322, 348.55615914, 348.55615914, 348.57037453, 349.11039574, 350.69679229, 351.20719509, 351.40738906, 351.55435898, 351.5762586, 351.88208475, 352.00003529, 357.27064552, 357.27064552, 357.30412793, 357.33761034, 357.59471722])
reallats = transpose([-64.42584563, -64.42584563, -51.9157984 , -68.16581176, -62.94481957, -63.84342467, -65.12200569, -62.94481957, -58.19337346, -63.20413417, -59.24569698, -73.57595893, -65.71550568, -73.57595893, -61.77109817, -67.35979729, -71.56636218, -66.71357904, -63.79264761, -62.41875341, -66.57589235, -67.33603103, -69.36022166, -62.5691665 , -62.34354687, -63.87204604, -63.41680408, -64.66910674, -64.32728801, -68.12666807, -67.48675127, -75.62084776, -68.32427247, -67.67873579, -71.29362044, -75.18151027, -74.82703281, -67.86003833, -67.53517002, -74.60769029, -74.47452896, -74.91300782, -69.20265748, -66.4523317 , -74.39535647, -67.84515592, -72.77129315, -65.99697951, -71.56304732, -73.25770588, -64.98109464, -66.7839299 , -65.3361847 , -63.96501392, -73.34798016, -69.00726035, -74.26508002, -74.26508002, -73.34798016, -64.36517353, -64.38103714, -67.84968026, -67.19293516, -62.51751923, -68.14626934, -67.98795927, -68.14626934, -62.66801348, -62.12584867, -50.40471644, -60.67970355, -67.99180558, -64.94934859, -67.41116723, -58.46531032, -65.55092427, -61.35232494, -62.39986155, -64.65797097, -64.65797097, -64.65797097, -66.31522913, -67.19630593, -64.4758729 , -63.17304399, -63.15094628, -63.06302112, -66.5695509 , -66.75645436, -65.70093238, -63.74791344, -66.66411226, -66.06983997, -66.06983997, -64.92589311, -66.11422109, -65.28693894, -64.84893732, -66.09888691, -69.41390112, -65.92144785, -57.770805 , -68.465629 , -63.8091461 , -64.75520112, -65.88124149, -64.23664359, -67.05357444, -63.51404137, -67.8206899 , -70.59310751, -67.05357444, -62.23289118, -63.65864576, -61.54378586, -61.54378586, -65.30519711, -65.56706329, -63.04774047, -62.95983271, -65.53065622, -62.48052497, -60.94278714, -61.45536642, -65.56767367, -69.61479762, -69.18057561, -67.90518311, -74.43563186, -67.45603438, -74.4227941 , -62.52800906, -63.66936825, -66.8489844 , -66.28964469, -64.49678719, -63.39356194, -63.78928175, -67.40852116, -71.13068507, -70.41447682, -72.38686962, -71.13068507, -65.53675116, -65.53401945, -58.22067082, -69.73709741, -66.9075402 , -68.32896736, -66.79928207, -63.22453105, -66.77649314, -74.1482634 , -73.23093503, -69.42974804, -69.58834498, -70.14080073, -70.193096 , -70.12622046, -65.31358477, -70.155381 , -70.09705991, -56.84150736, -55.15342114, -65.378361 , -65.69112773, -67.54407591, -67.54407591, -67.50639499, -68.60130019, -53.16686497, -69.52846636, -69.52846636, -69.79102763, -69.57304611, -69.57304611, -69.70678535, -69.61762586, -68.96116984, -69.61518915, -68.30715052, -68.01201928, -66.43775068, -66.6878871 , -65.47716953, -67.77602153, -73.72456917, -74.48984592, -72.08181311, -72.04747107, -65.69962825, -74.22955573, -64.1478153 , -68.04027358, -73.00214021, -71.02635051, -67.88449277, -72.13233624, -73.2097843 , -70.65687111, -72.01595235, -73.14414372, -73.04197921, -73.04197921, -66.89621171, -66.99719153, -67.68744918, -73.03377863, -72.72642723, -70.30962423, -72.8702989 , -70.84822341, -72.701883 , -72.13795316, -72.50098363, -70.63554314, -75.02926297, -72.80684985, -74.77777294, -71.19707121, -72.1927501 , -71.98969722, -74.64400101, -69.81248824, -75.1721882 , -76.49109604, -71.48912201, -71.76343412, -72.41217668, -71.62627806, -76.06263875, -71.18258268, -55.35787864, -74.91470119, -71.26233118, -71.67019841, -75.64066644, -50.06909651, -76.2327039 , -75.50306682, -85.19972204, -74.97510251, -75.20475515, -76.20726652, -70.75686069, -76.18247511, -76.18247511, -70.43048812, -69.74422932, -75.52863661, -69.93226411, -73.63826058, -69.68089591, -69.88194666, -69.20282695, -70.10756704, -74.39051557, -75.6624949 , -73.11853624, -74.47217578, -71.1521534 , -75.82581533, -67.91269949, -70.91462916, -67.92601711, -72.06926192, -70.78083976, -69.82668687, -67.68461106, -63.50516994, -66.35101086, -69.88478617, -67.47845708, -73.16394193, -66.3626131 , -65.76617758, -65.67934006, -66.87221108, -67.29897774, -65.855567 , -67.92541099, -66.63113361, -67.81643874, -67.76195262, -70.61342985, -67.31858745, -70.10814986, -71.97200741, -75.15957047, -67.15041087, -65.36534693, -67.49385186, -62.46676178, -68.44705032, -66.34823479, -58.58528878, -75.67556585, -66.8394257 , -65.75021804, -68.92313004, -67.33061661, -73.73595866, -68.35916121, -68.5387649 , -70.70484275, -69.68311335, -69.30166386, -64.90444854, -52.47570154, -67.43234283, -70.94056465, -71.63436272, -69.8444062 , -68.34496593, -66.06933826, -65.49977702, -68.94942795, -72.16263106, -72.44436874, -68.73496432, -70.44879769, -65.23261508, -64.9955425 , -64.7003875 , -64.34781389, -58.92285444, -70.77308686, -64.58934439, -68.71183937])

area2 = areaint(reallats, reallons)

;----

# From AIA 171 resampled... 

