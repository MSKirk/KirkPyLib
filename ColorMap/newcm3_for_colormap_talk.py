import numpy as np
from matplotlib.colors import ListedColormap
import matplotlib.pyplot as plt
import matplotlib.cm as cm
import astropy.units as u
import sunpy.map

# load in the data into a map
aia = sunpy.map.Map('/home/ireland/viscm/aialev1304a20100726t15060213zimagelev1fits.fits')

# ranges
a1 = 2001
a2 = 3000

b1 = 2001
b2 = 3000

a = (a1, a2) * u.pix
b = (b1, b2) * u.pix

# Test data
test_data=np.log(aia.data[a1:a2, b1:b2])


# New colormap
cm_type = "linear"

cm_data = [[ 0.0046689 , 0.03164455, 0.01248516],
           [ 0.00777535, 0.03480135, 0.01475265],
           [ 0.01119737, 0.03808512, 0.0171958 ],
           [ 0.01496919, 0.04145625, 0.01981665],
           [ 0.01910138, 0.04477035, 0.02261435],
           [ 0.02359714, 0.0480305 , 0.02558669],
           [ 0.02845413, 0.05124254, 0.02873022],
           [ 0.03368101, 0.054408  , 0.03204147],
           [ 0.0392777 , 0.05753128, 0.0355149 ],
           [ 0.04501362, 0.06061521, 0.03914373],
           [ 0.05064109, 0.063661  , 0.04283627],
           [ 0.0561968 , 0.06666716, 0.04645858],
           [ 0.06169429, 0.06963526, 0.05001587],
           [ 0.06715294, 0.07256355, 0.05350497],
           [ 0.07260546, 0.07544377, 0.05692521],
           [ 0.07806144, 0.0782745 , 0.06028233],
           [ 0.08354925, 0.08104529, 0.06359125],
           [ 0.08907001, 0.08375443, 0.06687914],
           [ 0.0946183 , 0.08640209, 0.07017996],
           [ 0.10018163, 0.08899181, 0.0735239 ],
           [ 0.10572659, 0.09153814, 0.07692623],
           [ 0.11123468, 0.09405191, 0.08038284],
           [ 0.11670161, 0.09653912, 0.0838773 ],
           [ 0.12213332, 0.09900134, 0.0873903 ],
           [ 0.12753317, 0.10144086, 0.09090497],
           [ 0.13291321, 0.10385493, 0.09441063],
           [ 0.13828063, 0.10624231, 0.0979011 ],
           [ 0.1436451 , 0.10859978, 0.10137416],
           [ 0.149011  , 0.11092632, 0.1048293 ],
           [ 0.15438267, 0.11322058, 0.10826733],
           [ 0.15976404, 0.11548118, 0.11168969],
           [ 0.16515623, 0.11770808, 0.11509778],
           [ 0.17056084, 0.1199009 , 0.11849313],
           [ 0.17597973, 0.12205899, 0.12187726],
           [ 0.18140552, 0.12418798, 0.12524197],
           [ 0.18685039, 0.12628153, 0.12858659],
           [ 0.19231532, 0.12833934, 0.13191186],
           [ 0.19780134, 0.13036101, 0.13521835],
           [ 0.20330826, 0.13234684, 0.13850645],
           [ 0.2088365 , 0.13429674, 0.14177644],
           [ 0.21438632, 0.13621072, 0.14502851],
           [ 0.21995849, 0.13808841, 0.14826278],
           [ 0.22555297, 0.13992994, 0.15147924],
           [ 0.23116975, 0.14173539, 0.15467782],
           [ 0.23680943, 0.14350445, 0.15785841],
           [ 0.24247242, 0.14523689, 0.16102081],
           [ 0.24815856, 0.14693283, 0.16416477],
           [ 0.25386812, 0.1485921 , 0.16729001],
           [ 0.25960193, 0.1502141 , 0.17039619],
           [ 0.26535896, 0.15179958, 0.17348243],
           [ 0.27114032, 0.15334773, 0.17654821],
           [ 0.27694588, 0.1548585 , 0.17959353],
           [ 0.28277609, 0.1563315 , 0.18261789],
           [ 0.28863135, 0.15776629, 0.18562072],
           [ 0.29451143, 0.15916292, 0.18860147],
           [ 0.3004172 , 0.16052058, 0.19155949],
           [ 0.30634815, 0.16183949, 0.19449417],
           [ 0.31230523, 0.16311871, 0.19740477],
           [ 0.31828794, 0.16435842, 0.20029056],
           [ 0.32429556, 0.16555929, 0.20314862],
           [ 0.33032939, 0.16671977, 0.20598019],
           [ 0.33638949, 0.16783952, 0.20878446],
           [ 0.34247662, 0.16891763, 0.21156049],
           [ 0.3485903 , 0.16995416, 0.21430746],
           [ 0.35473061, 0.17094882, 0.21702387],
           [ 0.36089669, 0.17190233, 0.21970651],
           [ 0.3670896 , 0.17281305, 0.222357  ],
           [ 0.37330987, 0.17368011, 0.22497421],
           [ 0.37955808, 0.17450256, 0.22755696],
           [ 0.38583216, 0.17528227, 0.23010167],
           [ 0.39213285, 0.17601798, 0.23260808],
           [ 0.39846119, 0.17670804, 0.2350764 ],
           [ 0.40481753, 0.1773516 , 0.23750532],
           [ 0.41119923, 0.17795138, 0.23988946],
           [ 0.41760849, 0.17850422, 0.24223056],
           [ 0.4240457 , 0.17900902, 0.24452801],
           [ 0.43050887, 0.17946774, 0.24677742],
           [ 0.4369984 , 0.17987937, 0.24897747],
           [ 0.44351578, 0.18024131, 0.25112922],
           [ 0.45005864, 0.18055607, 0.25322738],
           [ 0.45662756, 0.18082227, 0.25527122],
           [ 0.46322409, 0.18103707, 0.25726171],
           [ 0.46984395, 0.18120571, 0.25919068],
           [ 0.47649103, 0.18132217, 0.2610618 ],
           [ 0.48316293, 0.18138894, 0.26287067],
           [ 0.48985892, 0.18140636, 0.26461439],
           [ 0.49658059, 0.18137127, 0.26629407],
           [ 0.50332367, 0.18128919, 0.26790202],
           [ 0.51009261, 0.18115112, 0.26945197],
           [ 0.5168792 , 0.18096586, 0.27094693],
           [ 0.52369368, 0.18071914, 0.27238618],
           [ 0.53052719, 0.18042216, 0.27376459],
           [ 0.53738586, 0.18006565, 0.27508119],
           [ 0.54426597, 0.17965399, 0.27633159],
           [ 0.5511662 , 0.17918836, 0.27751235],
           [ 0.55808937, 0.17866389, 0.27862045],
           [ 0.56503156, 0.1780857 , 0.27965103],
           [ 0.57199071, 0.17745641, 0.28059935],
           [ 0.57896884, 0.17677255, 0.28146103],
           [ 0.58596393, 0.17603683, 0.28223062],
           [ 0.59297365, 0.17525276, 0.28290234],
           [ 0.59999535, 0.17442467, 0.28347003],
           [ 0.60702716, 0.1735562 , 0.28392604],
           [ 0.61406523, 0.17265439, 0.28426366],
           [ 0.62110729, 0.17172455, 0.28447374],
           [ 0.6281488 , 0.17077607, 0.28454827],
           [ 0.63518569, 0.16981849, 0.28447765],
           [ 0.64221016, 0.16886896, 0.28425154],
           [ 0.64921253, 0.16794944, 0.28385871],
           [ 0.65619068, 0.16706877, 0.28328916],
           [ 0.66312295, 0.16627432, 0.28253088],
           [ 0.67000457, 0.16558249, 0.28157524],
           [ 0.67681751, 0.16503677, 0.28041355],
           [ 0.68353783, 0.16469391, 0.27904002],
           [ 0.69014758, 0.16459957, 0.27745362],
           [ 0.69662174, 0.16481296, 0.27566145],
           [ 0.70293469, 0.16539356, 0.27367726],
           [ 0.70905974, 0.16639991, 0.27152569],
           [ 0.71507023, 0.16767088, 0.26926479],
           [ 0.72100441, 0.16912195, 0.26692274],
           [ 0.72686101, 0.17075512, 0.26450641],
           [ 0.73263929, 0.17257068, 0.26202252],
           [ 0.73833899, 0.17456734, 0.25947768],
           [ 0.74396035, 0.17674227, 0.25687817],
           [ 0.74950408, 0.17909128, 0.25422983],
           [ 0.75497124, 0.18160906, 0.25153829],
           [ 0.76036332, 0.18428922, 0.24880846],
           [ 0.76568214, 0.18712458, 0.24604459],
           [ 0.77092971, 0.19010741, 0.24325082],
           [ 0.77610834, 0.1932295 , 0.24043022],
           [ 0.78122043, 0.19648243, 0.23758596],
           [ 0.78626861, 0.19985765, 0.23471994],
           [ 0.79125553, 0.20334666, 0.23183413],
           [ 0.79618295, 0.20694296, 0.2289297 ],
           [ 0.80105269, 0.2106402 , 0.22600687],
           [ 0.80586908, 0.21442738, 0.22306688],
           [ 0.81063373, 0.21829905, 0.22010933],
           [ 0.8153477 , 0.22225111, 0.21713364],
           [ 0.82001611, 0.22627194, 0.21414026],
           [ 0.82463717, 0.2303634 , 0.2111256 ],
           [ 0.82912167, 0.23467128, 0.2081754 ],
           [ 0.83335796, 0.23936712, 0.20542563],
           [ 0.83735901, 0.24441022, 0.2029019 ],
           [ 0.84111453, 0.24979662, 0.20065931],
           [ 0.84464573, 0.25547326, 0.19871291],
           [ 0.84795279, 0.26142136, 0.1970997 ],
           [ 0.85106489, 0.26758087, 0.19581367],
           [ 0.85398674, 0.27393113, 0.19487393],
           [ 0.85674246, 0.28042616, 0.19426696],
           [ 0.85934992, 0.28703242, 0.19398128],
           [ 0.86182293, 0.29372468, 0.19400554],
           [ 0.86417483, 0.3004805 , 0.19432622],
           [ 0.86641635, 0.30728299, 0.1949264 ],
           [ 0.86855927, 0.31411504, 0.19579049],
           [ 0.87061237, 0.32096502, 0.19690072],
           [ 0.87258483, 0.3278216 , 0.1982406 ],
           [ 0.87448496, 0.33467538, 0.19979386],
           [ 0.87632023, 0.34151874, 0.20154468],
           [ 0.87809305, 0.34835033, 0.20348286],
           [ 0.87980267, 0.35517239, 0.2056022 ],
           [ 0.88146399, 0.36197003, 0.20787823],
           [ 0.88307263, 0.36874979, 0.2103114 ],
           [ 0.88463372, 0.37550807, 0.21288742],
           [ 0.88615159, 0.38224212, 0.21559642],
           [ 0.88762578, 0.3889542 , 0.21843398],
           [ 0.8890598 , 0.3956426 , 0.22138982],
           [ 0.8904574 , 0.40230544, 0.22445468],
           [ 0.89181288, 0.40894979, 0.2276316 ],
           [ 0.8931392 , 0.41556504, 0.23090085],
           [ 0.89442763, 0.42216101, 0.23426865],
           [ 0.89568235, 0.42873527, 0.23772705],
           [ 0.89690897, 0.43528437, 0.24126523],
           [ 0.89810567, 0.44181146, 0.24488234],
           [ 0.89926581, 0.4483236 , 0.2485831 ],
           [ 0.90039806, 0.45481464, 0.25235347],
           [ 0.90150544, 0.46128558, 0.25615457],
           [ 0.90260037, 0.46772911, 0.25994839],
           [ 0.90368297, 0.47414679, 0.26373398],
           [ 0.90475335, 0.48053995, 0.26751208],
           [ 0.90581168, 0.48690986, 0.27128326],
           [ 0.90685798, 0.49325785, 0.27504765],
           [ 0.9078923 , 0.49958515, 0.2788054 ],
           [ 0.9089148 , 0.50589295, 0.28255527],
           [ 0.90992545, 0.51218235, 0.28629872],
           [ 0.91092429, 0.51845441, 0.29003599],
           [ 0.91191141, 0.52471012, 0.29376725],
           [ 0.91288681, 0.5309505 , 0.29749259],
           [ 0.91385041, 0.53717663, 0.30121097],
           [ 0.91480228, 0.54338929, 0.30492393],
           [ 0.91574244, 0.54958936, 0.30863167],
           [ 0.91667076, 0.55577774, 0.31233443],
           [ 0.91758728, 0.56195524, 0.3160323 ],
           [ 0.91849193, 0.56812273, 0.31972438],
           [ 0.91938464, 0.57428091, 0.32341222],
           [ 0.92026534, 0.58043054, 0.32709607],
           [ 0.92113405, 0.58657226, 0.3307762 ],
           [ 0.92199059, 0.59270686, 0.33445289],
           [ 0.92283486, 0.59883508, 0.33812509],
           [ 0.9236669 , 0.60495743, 0.34179444],
           [ 0.92448649, 0.61107461, 0.34546126],
           [ 0.9252936 , 0.61718719, 0.34912586],
           [ 0.92608817, 0.62329573, 0.35278855],
           [ 0.92687002, 0.62940092, 0.35644859],
           [ 0.92763908, 0.63550325, 0.36010707],
           [ 0.92839534, 0.64160316, 0.36376459],
           [ 0.9291386 , 0.64770125, 0.36742145],
           [ 0.92986886, 0.65379794, 0.37107795],
           [ 0.93058603, 0.65989375, 0.37473384],
           [ 0.93128995, 0.66598919, 0.3783892 ],
           [ 0.93198069, 0.67208459, 0.38204504],
           [ 0.93265814, 0.67818039, 0.38570162],
           [ 0.93332224, 0.684277  , 0.38935917],
           [ 0.93397303, 0.69037477, 0.39301788],
           [ 0.93461041, 0.69647419, 0.39667676],
           [ 0.93523434, 0.70257557, 0.40033704],
           [ 0.935845  , 0.70867913, 0.40399892],
           [ 0.93644224, 0.71478532, 0.40766249],
           [ 0.93702616, 0.72089441, 0.4113278 ],
           [ 0.93759682, 0.72700671, 0.41499452],
           [ 0.93815415, 0.73312263, 0.418662  ],
           [ 0.93869838, 0.7392423 , 0.42233108],
           [ 0.93922947, 0.74536608, 0.42600163],
           [ 0.93974752, 0.75149423, 0.42967346],
           [ 0.94025269, 0.75762698, 0.43334634],
           [ 0.94074494, 0.76376469, 0.43701951],
           [ 0.94122441, 0.76990764, 0.44069238],
           [ 0.94169122, 0.77605601, 0.44436531],
           [ 0.94214535, 0.78221013, 0.44803786],
           [ 0.94257869, 0.78837431, 0.45170953],
           [ 0.94298481, 0.79455148, 0.45538624],
           [ 0.94337993, 0.80073373, 0.45907062],
           [ 0.94375961, 0.80692353, 0.46276205],
           [ 0.94412135, 0.81312232, 0.46645989],
           [ 0.94446267, 0.81933152, 0.47016342],
           [ 0.94479494, 0.82554603, 0.47387205],
           [ 0.94511048, 0.83176975, 0.47758498],
           [ 0.94540196, 0.83800627, 0.48130131],
           [ 0.94568819, 0.84424724, 0.48502057],
           [ 0.94595034, 0.85050151, 0.48874161],
           [ 0.94619912, 0.85676446, 0.49246384],
           [ 0.94642557, 0.86304034, 0.49618618],
           [ 0.94664176, 0.86932404, 0.49990814],
           [ 0.94683249, 0.87562249, 0.50362842],
           [ 0.94700657, 0.88193203, 0.50734645],
           [ 0.94716525, 0.88825237, 0.51106145],
           [ 0.94730174, 0.89458664, 0.51477235],
           [ 0.94741494, 0.90093548, 0.51847823],
           [ 0.94750736, 0.90729802, 0.52217841],
           [ 0.94757302, 0.91367691, 0.52587177],
           [ 0.94761785, 0.92006985, 0.52955787],
           [ 0.94763377, 0.92648031, 0.53323545],
           [ 0.94762459, 0.93290686, 0.53690403],
           [ 0.94757519, 0.93935569, 0.54056177],
           [ 0.94749449, 0.94582325, 0.54420855],
           [ 0.94735731, 0.95231954, 0.54784151],
           [ 0.94702561, 0.95889827, 0.5514468 ]]
test_cm = ListedColormap(cm_data, name="Test Colormap")

"""
fig = plt.figure(1)
ax = fig.add_subplot(111)
ax.imshow(test_data, interpolation='none', cmap=test_cm)
plt.gca().invert_yaxis()
plt.show()
"""

# Show the same submap with different colormaps
m_aia = aia.submap(a, b)
m_aia.peek(title='SDO AIA 304 $\AA$ data with standard colormap')

m_eit = aia.submap(a, b)
m_eit.plot_settings['cmap'] = cm.get_cmap('sohoeit304')
m_eit.peek(title='SDO AIA 304 $\AA$ data with SOHO EIT 304 $\AA$ colormap')

m_new = aia.submap(a, b)
m_new.plot_settings['cmap'] = test_cm
m_new.peek(title='SDO AIA 304 $\AA$ data with test colormap')

